---
  - name: Initial setup
    hosts: all
    roles:
      - init
    tags: init
  
  - name: Database server
    hosts: db_servers
    roles:
      - mysql
    tags: db 

  - name: update and setup agama
    hosts: web_servers
    roles:
      - agama
      - uwsgi
    tags: web

  - name: setup bind9
    hosts: dns_servers
    roles:
      - bind
    tags: dns

  - name: Change the dns resov for bind9
    hosts: all
    roles:
      - bind_resolv
    tags: dns_resolv

  - name: reconfig nginx
    hosts: web_servers
    roles:
      - nginx
    tags: nginx

  - name: Install and configure prometheus
    hosts: prometheus_servers
    roles:
      - prometheus
    tags: prom

  - name: Install Grafana
    hosts: grafana_servers
    roles:
      - grafana
    tags: grafana

  - name: Install influxdb and exporter
    hosts: influxdb_servers
    roles:
      - influxdb
      - influxdb_exporter
    tags: influxdb

  - name: Copy Pinger
    hosts: pinger_servers
    roles:
      - pinger
    tags: pinger



